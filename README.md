# Project Harimau ðŸ¯
> Documents are generated by AI (Primarily Gemini, occasionally Claude). Some human intervention was used for accuracy and guiding of AI. 

**AI-Powered Threat Intelligence Analysis Platform**

Project Harimau is an automated threat intelligence investigation system that analyzes IOCs from Google Threat Intelligence (GTI). Using a graph-based multi-agent architecture (LangGraph), it mimics how threat intelligence analysts work: systematically analyzing malware, mapping infrastructure, and synthesizing findings into actionable intelligence reports.

## Architecture
* **Frontend**: Streamlit (Cloud Run Service) - Interactive investigation dashboard
* **Backend**: FastAPI + LangGraph (Cloud Run Service) - Multi-agent orchestration
* **MCP**: Embedded GTI Server (stdio/Direct API) - Direct connection to threat intelligence
* **Brain**: Gemini 2.5 Flash / Pro - Powered by advanced AI reasoning
* **Investigation Cache**: NetworkX (in-memory graph per investigation)

## Core Capabilities
* **Automated Malware Analysis**: Deep behavioral analysis, capability assessment, and attribution tracking
* **Infrastructure Mapping**: Comprehensive DNS, IP, and hosting infrastructure analysis with pivot detection
* **Intelligence Synthesis**: Lead analyst agent correlates findings across malware and infrastructure domains
* **Rich Visualization**: Interactive knowledge graphs with threat scores, relationships, and entity details
* **Research Pivots**: Identifies intelligence gaps and suggests next research steps
* **Campaign Tracking**: Links IOCs to known threat actors and campaigns

## ðŸš€ Deployment (GCP)
1. **Prerequisites**: `gcloud` CLI installed and authenticated.
2. **Configuration**:
   ```bash
   # Export your GTI API Key (saved to Secret Manager)
   export GTI_API_KEY="your_actual_key_here"
   ```
3. **Deploy**:
   ```bash
   ./deploy.sh [backend|frontend|all]
   ```
   - **Default**: Deploys both.
   - **Backend only**: `./deploy.sh backend`
   - **Frontend only**: `./deploy.sh frontend`

4. **Verify**:
   ```bash
   curl -X POST "https://harimau-backend-<PROJECT_ID>.asia-southeast1.run.app/api/investigate" \
        -H "Content-Type: application/json" \
        -d '{"ioc": "44d88612fea8a8f36de82e1278abb02f"}'
   ```

## ðŸ“Š Status
- **Phase 1 (Infrastructure)**: âœ… Complete
- **Phase 2 (The Brain)**: âœ… Complete
- **Phase 3 (Interface)**: âœ… Complete
- **Phase 4 (Hybrid Triage + Token Optimization)**: âœ… Complete
- **Phase 5 (Enhanced Visualization + NetworkX Cache)**: âœ… Complete
- **Phase 6 (Threat Intelligence Refinement)**: ï¿½ In Progress

## Quick Start (Local)

1. **Clone & Env**:
   ```bash
   cp .env.example .env
   # Add GTI_API_KEY
   ```

2. **Run Backend**:
   ```bash
   cd backend && uvicorn main:app --reload
   ```

3. **Run Frontend**:
   ```bash
   cd app && streamlit run main.py
   ```

## Architecture Principles

### Multi-Agent Intelligence Workflow
1. **Triage Agent**: Initial IOC assessment and investigation planning (breadth-first)
2. **Specialist Agents**: Deep analysis in parallel
   - **Malware Specialist**: Behavioral analysis, capability assessment, attribution
   - **Infrastructure Specialist**: Network mapping, hosting analysis, pivot detection
3. **Lead Hunter**: Cross-domain synthesis and intelligence report generation

### Data Flow
1. **Fetch Full**: Agents fetch complete entity data from various tools ()
2. **Store All**: Full attributes cached in NetworkX graph (LangGraph state)
3. **Query Minimal**: LLM receives filtered summaries (token-efficient)
4. **Enrich On-Demand**: Specialists pull from cache (no re-fetch)
5. **Synthesize**: Lead Hunter correlates findings into actionable intelligence

### Agent Philosophy
- **Triage**: Quick assessment, relationship discovery
- **Specialists**: Deep domain expertise, intelligence gathering
- **Lead Hunter**: Strategic synthesis, campaign tracking, research gap identification

## Documentation
* [Product Requirements (PRD)](docs/PRD.md)
* [Architecture Proposal](docs/architecture.md)
* [Implementation Plan](docs/implementation_plan.md)

## Technology Stack
- **Orchestration**: LangGraph
- **API**: FastAPI
- **UI**: Streamlit
- **LLM**: Vertex AI (Gemini 2.5)
- **Cache**: NetworkX (in-memory)
- **Deployment**: Google Cloud Run
- **Secrets**: Google Secret Manager
